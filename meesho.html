<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meesho Clone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9f9f9;
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #f02d79;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #d41d63;
        }
        /* Style for active navigation link */
        .bottom-nav-item.active svg {
            color: #f02d79;
        }
        .bottom-nav-item.active span {
             color: #f02d79;
        }
        /* Animation for toast notification */
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(20px); }
            10%, 90% { opacity: 1; transform: translateY(0); }
        }
        .toast-notification {
            animation: fadeInOut 3s ease-in-out forwards;
        }
        
        .chat-bubble-user {
            background-color: #fce4ec; /* light pink */
            color: #881337;
            align-self: flex-end;
            border-radius: 20px 20px 4px 20px;
        }
        .chat-bubble-bot, .group-chat-other {
            background-color: #f3f4f6; /* light gray */
            color: #1f2937;
            align-self: flex-start;
            border-radius: 20px 20px 20px 4px;
        }
        .group-chat-own {
            background-color: #dcfce7; /* light green */
            color: #166534;
            align-self: flex-end;
            border-radius: 20px 20px 4px 20px;
        }

        /* Spin wheel styles */
        #wheel {
            background: conic-gradient(
                #a7f3d0 0deg 60deg,  /* 50 Points */
                #fecdd3 60deg 120deg, /* iPhone */
                #bfdbfe 120deg 180deg, /* 100 Points */
                #fef08a 180deg 240deg, /* Discount */
                #e9d5ff 240deg 300deg, /* 70 Points */
                #d9f99d 300deg 360deg  /* Windows 11 */
            );
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- App Container -->
    <div class="container mx-auto max-w-lg md:max-w-7xl bg-white min-h-screen pb-24">

        <!-- Header -->
        <header class="sticky top-0 z-40 bg-white shadow-md p-4 flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-pink-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z" fill="#f43f5e" />
                    <path d="M16.5 8C15.97 8 15.5 7.53 15.5 7C15.5 6.47 15.97 6 16.5 6C17.03 6 17.5 6.47 17.5 7C17.5 7.53 17.03 8 16.5 8ZM7.5 8C6.97 8 6.5 7.53 6.5 7C6.5 6.47 6.97 6 7.5 6C8.03 6 8.5 6.47 8.5 7C8.5 7.53 8.03 8 7.5 8ZM12 17.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5Z" fill="#fff" />
                </svg>
                <h1 class="text-2xl font-bold text-gray-800 tracking-wider">meesho</h1>
            </div>
            <!-- Search Bar -->
            <div class="relative flex-grow mx-4">
                <input type="text" id="searchInput" placeholder="Try Saree, Kurti or Search by Product Code" class="w-full bg-gray-100 border-2 border-gray-200 rounded-lg py-2 px-4 pl-10 focus:outline-none focus:border-pink-500 transition">
                <div class="absolute top-1/2 left-3 -translate-y-1/2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </div>
            </div>
            <!-- Action Icons -->
            <div class="flex items-center space-x-4">
                 <button class="relative text-gray-600 hover:text-pink-600" onclick="showPage('cartPage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-pink-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content" class="p-2 md:p-4">
            
            <!-- Home Page -->
            <div id="homePage">
                <!-- Hero Banner -->
                <div class="bg-pink-100 rounded-lg p-6 my-4 flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold text-pink-900">Lowest Prices</h2>
                        <p class="text-lg md:text-xl text-pink-800">Best Quality Shopping</p>
                        <button class="mt-4 bg-pink-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-pink-700 transition" onclick="showCategory('all')">Shop Now</button>
                    </div>
                    <img src="https://images.unsplash.com/photo-1567401893414-76b7b1e5a7a5?q=80&w=2070&auto=format&fit=crop" alt="Sale Banner" class="w-24 h-24 md:w-36 md:h-36 rounded-full object-cover">
                </div>
                
                <!-- Categories -->
                <section class="my-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Top Categories</h3>
                    <div id="categories-grid" class="grid grid-cols-4 md:grid-cols-8 gap-4 text-center">
                        <!-- Categories will be injected here by JS -->
                    </div>
                </section>

                <!-- Featured Products -->
                <section class="my-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Just For You</h3>
                    <div id="featured-products-grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
                        <!-- Products will be injected here by JS -->
                    </div>
                </section>
            </div>

            <!-- Products Page -->
            <div id="productsPage" class="hidden">
                 <h2 id="products-page-title" class="text-2xl font-bold text-gray-800 mb-4">Products</h2>
                 <div id="products-grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
                    <!-- Products list will be injected here by JS -->
                </div>
            </div>
            
            <!-- Product Detail Page -->
            <div id="productDetailPage" class="hidden">
                <!-- Product detail content will be injected by JS -->
            </div>

            <!-- Cart Page -->
            <div id="cartPage" class="hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Your Shopping Cart</h2>
                <div id="cart-items-container">
                    <!-- Cart items will be injected by JS -->
                </div>
                <div id="cart-summary" class="mt-6 p-4 bg-gray-100 rounded-lg">
                    <!-- Cart summary will be injected by JS -->
                </div>
            </div>

             <!-- My Orders Page -->
            <div id="ordersPage" class="hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">My Orders</h2>
                <div id="orders-list-container" class="space-y-4">
                    <!-- Orders will be injected here by JS -->
                </div>
            </div>

            <!-- Trends Page -->
            <div id="trendsPage" class="hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Community Trends</h2>
                <div id="trends-feed-container" class="space-y-6">
                    <!-- Trends posts will be injected here -->
                </div>
            </div>

            <!-- Play and Win Page -->
            <div id="playAndWinPage" class="hidden text-center p-4 flex flex-col items-center justify-center min-h-[70vh]">
                <h2 class="text-3xl font-bold text-gray-800 mb-8">Spin to Win!</h2>
                <div class="relative inline-block mb-8">
                    <div id="wheel-pointer" class="absolute -top-2 left-1/2 -translate-x-1/2 z-10" style="width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-top: 30px solid #ec4899;"></div>
                    <div id="wheel" class="relative w-80 h-80 rounded-full border-4 border-pink-300 transition-transform duration-[5000ms] ease-out flex items-center justify-center">
                        <div id="wheel-labels" class="absolute inset-0">
                            <!-- Labels will be positioned by JS -->
                        </div>
                    </div>
                </div>
                <button id="spin-btn" class="w-full max-w-xs mx-auto bg-pink-600 text-white font-bold py-4 px-6 rounded-full hover:bg-pink-700 transition text-2xl shadow-lg disabled:bg-gray-400">
                    SPIN
                </button>
            </div>

            <!-- Account Page -->
            <div id="accountPage" class="hidden">
                <!-- Account content will be injected by JS -->
            </div>

            <!-- Groups List Page -->
            <div id="groupsListPage" class="hidden">
                <!-- Groups list will be injected by JS -->
            </div>

            <!-- Group Chat Page (Full screen) -->
            <div id="groupChatPage" class="hidden fixed inset-0 bg-gray-100 z-50 flex flex-col">
                 <!-- Chat Header -->
                <header class="bg-pink-600 text-white p-4 flex items-center shadow-md">
                    <button onclick="showPage('groupsListPage')" class="mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    </button>
                    <img src="https://placehold.co/40x40/fbcfe8/9d174d?text=Style" alt="Group Icon" class="w-10 h-10 rounded-full mr-3">
                    <div>
                        <h3 class="font-bold">Style Savvy Group</h3>
                        <p class="text-xs text-pink-200">Aanya, Riya, Sudhanshu, & 12 more</p>
                    </div>
                </header>
                <!-- Chat Messages -->
                <main id="group-chat-messages" class="flex-grow p-4 overflow-y-auto flex flex-col space-y-4">
                    <!-- Messages will be injected here -->
                </main>
                <!-- Chat Input -->
                <footer class="p-4 bg-white border-t">
                     <div class="relative">
                        <input type="text" id="group-chat-input" placeholder="Type a message..." class="w-full border-2 border-gray-300 rounded-full py-2 px-4 pr-12 focus:outline-none focus:border-pink-500">
                        <button id="send-group-chat-btn" class="absolute right-1 top-1/2 -translate-y-1/2 bg-pink-600 text-white rounded-full h-9 w-9 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" /></svg>
                        </button>
                    </div>
                </footer>
            </div>

        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_5px_rgba(0,0,0,0.1)] max-w-lg md:max-w-7xl mx-auto border-t z-40">
            <div class="flex justify-around py-2">
                <button class="bottom-nav-item flex flex-col items-center text-gray-600 hover:text-pink-600 w-full active" data-page="homePage">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                    <span class="text-xs font-medium">Home</span>
                </button>
                <button class="bottom-nav-item flex flex-col items-center text-gray-600 hover:text-pink-600 w-full" data-page="productsPage">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                    <span class="text-xs font-medium">Categories</span>
                </button>
                 <button class="bottom-nav-item flex flex-col items-center text-gray-600 hover:text-pink-600 w-full" data-page="ordersPage">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg>
                    <span class="text-xs font-medium">My Orders</span>
                </button>
                 <button class="bottom-nav-item flex flex-col items-center text-gray-600 hover:text-pink-600 w-full" data-page="trendsPage">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    <span class="text-xs font-medium">Trends</span>
                </button>
                <button class="bottom-nav-item flex flex-col items-center text-gray-600 hover:text-pink-600 w-full" data-page="playAndWinPage">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <span class="text-xs font-medium">Play & Win</span>
                </button>
                <button class="bottom-nav-item flex flex-col items-center text-gray-600 hover:text-pink-600 w-full" data-page="accountPage">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                    <span class="text-xs font-medium">Account</span>
                </button>
            </div>
        </nav>

    </div>
    
    <!-- Toast Notification -->
    <div id="toast-notification" class="fixed bottom-24 right-4 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 z-50">
        Item added to cart!
    </div>
    
    <!-- AI Chatbot Button -->
    <button id="chatbot-toggle" class="fixed bottom-24 right-4 bg-pink-600 text-white rounded-full h-14 w-14 flex items-center justify-center shadow-lg hover:bg-pink-700 transition z-50">
         <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
            <path d="M17.293 13.293A8 8 0 0110 18a8 8 0 01-7.293-4.707A6.977 6.977 0 013 13H2a1 1 0 01-1-1v-2a1 1 0 011-1h1a6.977 6.977 0 01.03-1H2a1 1 0 01-1-1V5a1 1 0 011-1h1.03a6.977 6.977 0 010-1H2a1 1 0 01-1-1V1a1 1 0 011-1h2a1 1 0 011 1v1h10V1a1 1 0 011-1h2a1 1 0 011 1v1a1 1 0 01-1 1h-1.03c.02.329.03.663.03 1H18a1 1 0 011 1v2a1 1 0 01-1 1h-1a6.977 6.977 0 01-.03 1H18a1 1 0 011 1v2a1 1 0 01-1 1h-1a6.977 6.977 0 01-1.707.293z" />
        </svg>
    </button>

    <!-- AI Chatbot Modal -->
    <div id="chatbot-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 items-end justify-center z-50">
        <div id="chatbot-modal-content" class="bg-white rounded-t-2xl shadow-xl w-full max-w-lg h-[80vh] flex flex-col transform transition-transform translate-y-full">
            <!-- Header -->
            <div class="p-4 border-b flex justify-between items-center bg-pink-600 text-white rounded-t-2xl">
                <div>
                    <h3 class="font-bold text-lg">AI Shopping Assistant</h3>
                    <p class="text-xs text-pink-100">Here to help you find the best products!</p>
                </div>
                <button id="close-chatbot-btn" class="p-1 rounded-full text-pink-100 hover:bg-pink-500 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <!-- Messages -->
            <div id="chat-messages" class="flex-grow p-4 overflow-y-auto flex flex-col space-y-4">
                <!-- Chat messages will be appended here -->
            </div>
            <!-- Input -->
            <div class="p-4 border-t bg-white">
                <div class="relative">
                    <input type="text" id="chat-input" placeholder="Ask for sarees, kurtis..." class="w-full border-2 border-gray-300 rounded-full py-2 px-4 pr-12 focus:outline-none focus:border-pink-500">
                    <button id="send-chat-btn" class="absolute right-1 top-1/2 -translate-y-1/2 bg-pink-600 text-white rounded-full h-9 w-9 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" /></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Share to Group Modal -->
    <div id="share-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-lg">Share Product to a Group</h3>
                <button onclick="hideShareModal()" class="p-1 rounded-full text-gray-500 hover:bg-gray-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div id="share-group-list" class="space-y-2">
                <!-- Group list will be populated here -->
            </div>
        </div>
    </div>

    <!-- Referral Modal -->
    <div id="referral-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-lg">Refer & Earn More Points!</h3>
                <button onclick="hideReferralModal()" class="p-1 rounded-full text-gray-500 hover:bg-gray-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <p class="text-gray-600 mb-4">Share this link with your friends. When they sign up, you both get bonus points!</p>
            <div class="relative bg-gray-100 p-3 rounded-lg flex items-center">
                <input type="text" id="referral-link-input" value="https://meesho-clone.app/refer?code=SUDHANSHU123" readonly class="bg-transparent text-gray-700 w-full outline-none">
                <button onclick="copyReferralLink()" class="bg-pink-600 text-white font-semibold py-1 px-3 rounded-lg hover:bg-pink-700 transition">
                    Copy
                </button>
            </div>
        </div>
    </div>

    <!-- Question Modal -->
    <div id="question-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-6 text-center">
            <h3 id="question-text" class="font-bold text-lg mb-4">What is 5 + 5?</h3>
            <div id="question-options" class="space-y-3 mb-6">
                <button class="w-full border-2 border-gray-300 rounded-md py-3 px-4 hover:border-pink-500 focus:border-pink-500 focus:outline-none transition" onclick="checkAnswer(10)">10</button>
                <button class="w-full border-2 border-gray-300 rounded-md py-3 px-4 hover:border-pink-500 focus:border-pink-500 focus:outline-none transition" onclick="checkAnswer(55)">55</button>
            </div>
        </div>
    </div>

    <!-- AR View Modal -->
    <div id="ar-view-modal" class="hidden fixed inset-0 bg-black z-50 flex flex-col items-center justify-center">
        <video id="ar-video" class="w-full h-full object-cover" autoplay playsinline></video>
        <button onclick="stopARView()" class="absolute top-4 right-4 bg-white/50 text-white font-bold py-2 px-4 rounded-full hover:bg-white/75 transition">
            Close
        </button>
    </div>


    <script>
        // --- DATA ---
        const products = [
            { id: 1, name: 'Elegant Banarasi Saree', category: 'Sarees', price: 1299, originalPrice: 2599, rating: 4.5, reviews: 120, images: ['https://images.unsplash.com/photo-1610192498718-34222a7f8d16?q=80&w=870&auto=format&fit=crop', 'https://images.unsplash.com/photo-1617044645239-5103c88686c5?q=80&w=870&auto=format&fit=crop'], sizes: ['Free Size'], description: 'A beautiful silk blend saree with intricate zari work, perfect for weddings and festive occasions.' },
            { id: 2, name: 'Cotton Anarkali Kurti', category: 'Kurtis', price: 799, originalPrice: 1500, rating: 4.2, reviews: 250, images: ['https://images.unsplash.com/photo-1623945484068-99e29f0e13a4?q=80&w=870&auto=format&fit=crop', 'https://images.unsplash.com/photo-1623945484013-1f0f0b3b1b68?q=80&w=870&auto=format&fit=crop'], sizes: ['M', 'L', 'XL', 'XXL'], description: 'Comfortable and stylish cotton Anarkali Kurti. Ideal for casual wear.' },
            { id: 3, name: 'Men\'s Graphic T-Shirt', category: 'Men', price: 499, originalPrice: 999, rating: 4.8, reviews: 500, images: ['https://images.unsplash.com/photo-1576566588028-4147f3842f27?q=80&w=987&auto=format&fit=crop'], sizes: ['S', 'M', 'L', 'XL'], description: '100% cotton graphic printed t-shirt. Soft, breathable, and durable.' },
            { id: 4, name: 'Baby Romper Suit', category: 'Kids', price: 399, originalPrice: 799, rating: 4.9, reviews: 80, images: ['https://images.unsplash.com/photo-1604467795338-5188b7f161a2?q=80&w=870&auto=format&fit=crop'], sizes: ['0-3M', '3-6M', '6-9M'], description: 'Adorable and soft romper suit for your little one. Made with baby-safe materials.' },
            { id: 5, name: 'Non-stick Cookware Set', category: 'Home', price: 1999, originalPrice: 3999, rating: 4.6, reviews: 150, images: ['https://images.unsplash.com/photo-1583777531581-391ab1a1714e?q=80&w=870&auto=format&fit=crop'], sizes: [], description: 'A complete set of non-stick cookware for your kitchen. Includes a frying pan, a kadhai, and a tawa.' },
            { id: 6, name: 'Designer Georgette Saree', category: 'Sarees', price: 999, originalPrice: 1999, rating: 4.3, reviews: 95, images: ['https://images.unsplash.com/photo-1616559099958-3d2b2c915f4a?q=80&w=870&auto=format&fit=crop'], sizes: ['Free Size'], description: 'Lightweight georgette saree with a modern design. Comes with a matching blouse piece.' },
            { id: 7, name: 'Straight Rayon Kurti', category: 'Kurtis', price: 649, originalPrice: 1299, rating: 4.1, reviews: 180, images: ['https://images.unsplash.com/photo-1623945484128-2a9f5d1b379e?q=80&w=870&auto=format&fit=crop'], sizes: ['M', 'L', 'XL'], description: 'Elegant straight-fit rayon kurti with beautiful embroidery. Perfect for office or daily wear.' },
            { id: 8, name: 'Men\'s Casual Shirt', category: 'Men', price: 899, originalPrice: 1799, rating: 4.7, reviews: 320, images: ['https://images.unsplash.com/photo-1603252109303-2751441dd157?q=80&w=870&auto=format&fit=crop'], sizes: ['M', 'L', 'XL', 'XXL'], description: 'A stylish and comfortable casual shirt for men, made from premium cotton fabric.' },
            { id: 9, name: 'Girls\' Frock Dress', category: 'Kids', price: 599, originalPrice: 1199, rating: 4.8, reviews: 65, images: ['https://images.unsplash.com/photo-1594736224133-7a9e60408226?q=80&w=870&auto=format&fit=crop'], sizes: ['2-3Y', '4-5Y', '6-7Y'], description: 'A cute and comfortable frock for girls, perfect for parties and special occasions.' },
            { id: 10, name: 'Cotton Bedsheet Set', category: 'Home', price: 1499, originalPrice: 2999, rating: 4.4, reviews: 210, images: ['https://images.unsplash.com/photo-1582582494705-5ea229b82c2b?q=80&w=870&auto=format&fit=crop'], sizes: ['King Size'], description: 'High-quality cotton bedsheet set with two pillow covers. Soft, breathable, and easy to wash.' },
        ];
        
        const categories = [
            { name: 'Sarees', img: 'https://placehold.co/100x100/fbcfe8/9d174d?text=Sarees' },
            { name: 'Kurtis', img: 'https://placehold.co/100x100/dbeafe/1e40af?text=Kurtis' },
            { name: 'Men', img: 'https://placehold.co/100x100/ccfbf1/0f766e?text=Men' },
            { name: 'Kids', img: 'https://placehold.co/100x100/fef3c7/b45309?text=Kids' },
            { name: 'Home', img: 'https://placehold.co/100x100/f3e8ff/581c87?text=Home' },
            { name: 'Beauty', img: 'https://placehold.co/100x100/fce7f3/9d174d?text=Beauty' },
            { name: 'Jewellery', img: 'https://placehold.co/100x100/fef9c3/854d0e?text=Jewellery' },
            { name: 'Electronics', img: 'https://placehold.co/100x100/e0e7ff/3730a3?text=Gadgets' },
        ];
        
        const trends = [
            { id: 1, userName: 'Aanya Sharma', userImage: 'https://placehold.co/100x100/fecaca/7f1d1d?text=AS', postImage: 'https://images.unsplash.com/photo-1623945484068-99e29f0e13a4?q=80&w=870&auto=format&fit=crop', caption: 'Absolutely in love with the new floral print kurtis! They are perfect for this season. ðŸŒ¸ #Kurtis #FloralLove', likes: 256, comments: 22, liked: false },
            { id: 2, userName: 'Rohan Verma', userImage: 'https://placehold.co/100x100/dbeafe/1e3a8a?text=RV', postImage: 'https://images.unsplash.com/photo-1576566588028-4147f3842f27?q=80&w=987&auto=format&fit=crop', caption: 'Found the best graphic tees on Meesho. The quality is top-notch! Highly recommend. #MensFashion #Tshirt', likes: 189, comments: 12, liked: false },
            { id: 3, userName: 'Priya Patel', userImage: 'https://placehold.co/100x100/d9f99d/365314?text=PP', postImage: 'https://images.unsplash.com/photo-1616559099958-3d2b2c915f4a?q=80&w=870&auto=format&fit=crop', caption: 'This Georgette Saree is a game-changer for evening parties. So elegant and lightweight! âœ¨ #SareeStyle', likes: 432, comments: 45, liked: false },
        ];

        const wheelPrizes = [
            { label: '50 Points', value: 50 },
            { label: 'Win an iPhone', value: 'iPhone' },
            { label: '100 Points', value: 100 },
            { label: 'Win Discount', value: 'Discount' },
            { label: '70 Points', value: 70 },
            { label: 'Win Windows 11', value: 'Windows' },
        ];

        let groupChatMessages = [
            { sender: 'Riya Gupta', text: 'Hey everyone! Did you see the new saree collection? The Banarasi one is gorgeous!', timestamp: '9:30 PM' },
            { sender: 'Aanya Sharma', text: 'Yes! I was just looking at it. Planning to buy it for the upcoming festival.', timestamp: '9:31 PM' },
            { sender: 'Sudhanshu Singh', text: 'It does look amazing. The prices are great too.', timestamp: '9:32 PM' },
        ];


        // --- STATE ---
        let cart = [];
        let orders = [];
        let currentPage = 'homePage';
        let productIdToShare = null;
        let rewardPoints = 500;
        let currentPrize = null;
        let isSpinning = false;
        let arStream = null;
        
        // --- DOM ELEMENTS ---
        const mainContent = document.getElementById('main-content');
        const pages = {
            homePage: document.getElementById('homePage'),
            productsPage: document.getElementById('productsPage'),
            productDetailPage: document.getElementById('productDetailPage'),
            cartPage: document.getElementById('cartPage'),
            ordersPage: document.getElementById('ordersPage'),
            trendsPage: document.getElementById('trendsPage'),
            playAndWinPage: document.getElementById('playAndWinPage'),
            accountPage: document.getElementById('accountPage'),
            groupsListPage: document.getElementById('groupsListPage'),
            groupChatPage: document.getElementById('groupChatPage'),
        };
        const cartCountEl = document.getElementById('cart-count');
        const searchInput = document.getElementById('searchInput');
        // Chatbot elements
        const chatbotToggle = document.getElementById('chatbot-toggle');
        const chatbotModal = document.getElementById('chatbot-modal');
        const chatbotModalContent = document.getElementById('chatbot-modal-content');
        const closeChatbotBtn = document.getElementById('close-chatbot-btn');
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendChatBtn = document.getElementById('send-chat-btn');
        // Group Chat Elements
        const groupChatMessagesContainer = document.getElementById('group-chat-messages');
        const groupChatInput = document.getElementById('group-chat-input');
        const sendGroupChatBtn = document.getElementById('send-group-chat-btn');
        // Share Modal
        const shareModal = document.getElementById('share-modal');
        // Referral Modal
        const referralModal = document.getElementById('referral-modal');
        // Question Modal
        const questionModal = document.getElementById('question-modal');
        // AR Modal
        const arViewModal = document.getElementById('ar-view-modal');


        // --- RENDER FUNCTIONS ---
        
        function createProductCard(product) {
            const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
            return `
                <div class="bg-white rounded-lg shadow-md overflow-hidden cursor-pointer hover:shadow-xl transition transform hover:-translate-y-1" onclick="showProductDetail(${product.id})">
                    <img src="${product.images[0]}" alt="${product.name}" class="w-full h-48 object-cover">
                    <div class="p-3">
                        <h4 class="text-sm font-medium text-gray-700 truncate">${product.name}</h4>
                        <div class="flex items-center mt-2">
                            <span class="text-lg font-bold text-gray-900">â‚¹${product.price}</span>
                            <span class="text-xs text-gray-500 line-through ml-2">â‚¹${product.originalPrice}</span>
                            <span class="text-xs font-semibold text-green-600 ml-2">${discount}% off</span>
                        </div>
                         <div class="mt-2 bg-green-100 text-green-800 text-xs font-semibold px-2.5 py-0.5 rounded-full inline-flex items-center">
                            ${product.rating} â˜…
                        </div>
                         <p class="text-xs text-gray-500 mt-1">${product.reviews} Reviews</p>
                    </div>
                </div>
            `;
        }
        
        function renderHomePage() {
            // Render Categories
            const categoriesGrid = document.getElementById('categories-grid');
            categoriesGrid.innerHTML = categories.map(cat => `
                <div class="flex flex-col items-center cursor-pointer" onclick="showCategory('${cat.name}')">
                    <img src="${cat.img}" alt="${cat.name}" class="w-16 h-16 md:w-20 md:h-20 rounded-full border-2 border-pink-200 object-cover">
                    <span class="text-xs md:text-sm font-medium mt-2 text-gray-700">${cat.name}</span>
                </div>
            `).join('');
            
            // Render Featured Products
            const featuredProductsGrid = document.getElementById('featured-products-grid');
            featuredProductsGrid.innerHTML = products.slice(0, 10).map(createProductCard).join('');
        }
        
        function renderProductsPage(productArray, title) {
            const productsGrid = document.getElementById('products-grid');
            document.getElementById('products-page-title').textContent = title;
            if (productArray.length === 0) {
                 productsGrid.innerHTML = `<p class="col-span-full text-center text-gray-500">No products found.</p>`;
            } else {
                productsGrid.innerHTML = productArray.map(createProductCard).join('');
            }
        }
        
        function renderProductDetailPage(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
            
            pages.productDetailPage.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg">
                    <!-- Image Gallery -->
                    <div class="p-4">
                        <img src="${product.images[0]}" alt="${product.name}" class="w-full rounded-lg object-cover">
                        <!-- Thumbnails for multiple images -->
                         ${product.images.length > 1 ? `
                            <div class="flex space-x-2 mt-4">
                                ${product.images.map((img, index) => `<img src="${img}" class="w-16 h-16 rounded-md border-2 ${index === 0 ? 'border-pink-500' : 'border-transparent'} cursor-pointer">`).join('')}
                            </div>
                        ` : ''}
                    </div>
                    
                    <!-- Product Info -->
                    <div class="p-4 border-t">
                        <h2 class="text-2xl font-bold text-gray-800">${product.name}</h2>
                        <div class="flex items-center my-2">
                             <span class="text-3xl font-bold text-gray-900">â‚¹${product.price}</span>
                             <span class="text-md text-gray-500 line-through ml-3">â‚¹${product.originalPrice}</span>
                             <span class="text-md font-semibold text-green-600 ml-3">${discount}% off</span>
                        </div>
                         <div class="mt-2 inline-flex items-center bg-green-100 text-green-800 text-md font-semibold px-3 py-1 rounded-full">
                            ${product.rating} â˜… <span class="text-sm font-normal ml-2 text-gray-600">(${product.reviews} Reviews)</span>
                        </div>
                    </div>
                    
                    <!-- Size Selector -->
                    ${product.sizes.length > 0 ? `
                        <div class="p-4 border-t">
                            <h3 class="font-semibold text-gray-700 mb-2">Select Size</h3>
                            <div class="flex flex-wrap gap-2">
                                ${product.sizes.map(size => `<button class="border-2 border-gray-300 rounded-md py-2 px-4 hover:border-pink-500 focus:border-pink-500 focus:outline-none transition">${size}</button>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <!-- Action Buttons -->
                    <div class="p-4 border-t space-y-3 sticky bottom-20 md:bottom-0 bg-white">
                        <div class="grid grid-cols-2 gap-4">
                            <button class="w-full border-2 border-pink-600 text-pink-600 font-bold py-3 rounded-lg hover:bg-pink-50 transition" onclick="addToCart(${product.id})">
                                Add to Cart
                            </button>
                            <button class="w-full bg-pink-600 text-white font-bold py-3 rounded-lg hover:bg-pink-700 transition" onclick="handleBuyNow(${product.id})">
                                Buy Now
                            </button>
                        </div>
                        <button class="w-full flex items-center justify-center gap-2 bg-gray-100 text-gray-800 font-bold py-3 rounded-lg hover:bg-gray-200 transition" onclick="showShareModal(${product.id})">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z" />
                            </svg>
                            Share with Friends
                        </button>
                        <button class="w-full flex items-center justify-center gap-2 bg-purple-100 text-purple-800 font-bold py-3 rounded-lg hover:bg-purple-200 transition" onclick="startARView()">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                            Try with AR
                        </button>
                    </div>

                    <!-- Product Details -->
                    <div class="p-4 border-t">
                         <h3 class="font-semibold text-gray-700 mb-2">Product Details</h3>
                         <p class="text-gray-600">${product.description}</p>
                    </div>
                </div>
            `;
        }
        
        function renderCartPage() {
            const cartItemsContainer = document.getElementById('cart-items-container');
            const cartSummary = document.getElementById('cart-summary');
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = `<div class="text-center py-12">
                    <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-24 w-24 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                    <h3 class="mt-4 text-xl font-semibold text-gray-700">Your Cart is Empty</h3>
                    <p class="text-gray-500 mt-2">Looks like you haven't added anything to your cart yet.</p>
                     <button class="mt-6 bg-pink-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-pink-700 transition" onclick="showPage('homePage')">Continue Shopping</button>
                </div>`;
                cartSummary.innerHTML = '';
                return;
            }
            
            cartItemsContainer.innerHTML = cart.map(item => {
                const product = products.find(p => p.id === item.id);
                return `
                    <div class="flex items-center bg-white p-4 rounded-lg shadow-sm mb-4">
                        <img src="${product.images[0]}" alt="${product.name}" class="w-24 h-24 rounded-md object-cover">
                        <div class="flex-grow ml-4">
                            <h4 class="font-semibold text-gray-800">${product.name}</h4>
                            <p class="text-gray-600 font-bold mt-1">â‚¹${product.price}</p>
                            <div class="flex items-center mt-2">
                                <span class="text-gray-600">Qty:</span>
                                <div class="flex items-center ml-2 border rounded">
                                    <button class="px-2 py-1" onclick="updateQuantity(${item.id}, -1)">-</button>
                                    <span class="px-3">${item.quantity}</span>
                                    <button class="px-2 py-1" onclick="updateQuantity(${item.id}, 1)">+</button>
                                </div>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-red-500" onclick="removeFromCart(${item.id})">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                        </button>
                    </div>
                `;
            }).join('');
            
            const subtotal = cart.reduce((sum, item) => {
                const product = products.find(p => p.id === item.id);
                return sum + (product.price * item.quantity);
            }, 0);
            const deliveryFee = subtotal > 500 ? 0 : 40;
            const total = subtotal + deliveryFee;
            
            cartSummary.innerHTML = `
                <h3 class="text-lg font-bold text-gray-800 mb-4">Price Details</h3>
                <div class="space-y-2 text-gray-700">
                    <div class="flex justify-between"><span>Subtotal</span><span>â‚¹${subtotal.toFixed(2)}</span></div>
                    <div class="flex justify-between"><span>Delivery Fee</span><span>${deliveryFee > 0 ? 'â‚¹' + deliveryFee.toFixed(2) : '<span class="text-green-600">FREE</span>'}</span></div>
                    <hr class="my-2">
                    <div class="flex justify-between font-bold text-lg text-gray-900"><span>Total Amount</span><span>â‚¹${total.toFixed(2)}</span></div>
                </div>
                 <button class="mt-6 w-full bg-pink-600 text-white font-bold py-3 rounded-lg hover:bg-pink-700 transition" onclick="handleCheckout()">Proceed to Checkout</button>
            `;
        }

        function renderOrdersPage() {
            const container = document.getElementById('orders-list-container');
            if (orders.length === 0) {
                container.innerHTML = `
                <div class="text-center py-12">
                    <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-24 w-24 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/></svg>
                    <h3 class="mt-4 text-xl font-semibold text-gray-700">No Orders Yet</h3>
                    <p class="text-gray-500 mt-2">You haven't placed any orders with us. Let's change that!</p>
                    <button class="mt-6 bg-pink-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-pink-700 transition" onclick="showPage('homePage')">Start Shopping</button>
                </div>`;
                return;
            }
            container.innerHTML = orders.map(order => `
                <div class="bg-white p-4 rounded-lg shadow-sm border">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <span class="font-bold text-gray-800">Order ID: ${order.id}</span>
                            <p class="text-sm text-gray-500">Placed on: ${order.date}</p>
                        </div>
                        <span class="text-sm font-medium px-2 py-1 rounded-full ${order.status === 'Delivered' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">${order.status}</span>
                    </div>
                    
                    <div class="border-t my-2">
                    ${order.items.map(item => `
                        <div class="flex items-center py-3">
                            <img src="${item.images[0]}" class="w-16 h-16 rounded-md object-cover">
                            <div class="ml-4 flex-grow">
                                 <p class="font-semibold text-gray-700">${item.name}</p>
                                 <p class="text-sm text-gray-600">Qty: ${item.quantity}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm text-gray-800 font-semibold">â‚¹${item.price * item.quantity}</p>
                            </div>
                        </div>
                    `).join('')}
                    </div>
                    <div class="text-right font-bold text-lg mt-2 border-t pt-2">
                        Total: â‚¹${order.total.toFixed(2)}
                    </div>
                </div>
            `).join('');
        }
        
        function renderTrendsPage() {
            const container = document.getElementById('trends-feed-container');
            container.innerHTML = trends.map(post => `
                <div class="bg-white rounded-lg shadow-sm border">
                    <!-- Post Header -->
                    <div class="flex items-center p-3">
                        <img src="${post.userImage}" alt="${post.userName}" class="w-10 h-10 rounded-full">
                        <span class="ml-3 font-semibold text-gray-800">${post.userName}</span>
                    </div>
                    <!-- Post Image -->
                    <img src="${post.postImage}" alt="Trend Post" class="w-full h-96 object-cover">
                    <!-- Post Actions -->
                    <div class="p-3 flex items-center space-x-4">
                        <button class="flex items-center space-x-1 ${post.liked ? 'text-pink-600' : 'text-gray-600'} hover:text-pink-600" onclick="handleLike(${post.id})">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="${post.liked ? 'currentColor' : 'none'}" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                            </svg>
                            <span>${post.likes}</span>
                        </button>
                        <button class="flex items-center space-x-1 text-gray-600 hover:text-blue-600">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>
                            <span>${post.comments}</span>
                        </button>
                    </div>
                    <!-- Post Caption -->
                    <div class="px-3 pb-3">
                        <p class="text-gray-700"><span class="font-semibold text-gray-800">${post.userName}</span> ${post.caption}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderAccountPage() {
            pages.accountPage.innerHTML = `
                <h2 class="text-2xl font-bold text-gray-800 mb-4">My Account</h2>
                <div class="bg-white p-6 rounded-lg shadow-sm text-center">
                    <img src="https://placehold.co/150x150/c7d2fe/312e81?text=SS" alt="User Profile" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-pink-200">
                    <h3 class="text-xl font-semibold">Sudhanshu Singh</h3>
                    <p class="text-gray-500">sudhanshu.singh@example.com</p>
                </div>

                <!-- Rewards Section -->
                <div class="mt-6 bg-white p-4 rounded-lg shadow-sm flex items-center justify-between">
                    <div class="flex items-center">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-500 mr-3" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                        </svg>
                        <div>
                            <h4 class="font-semibold text-gray-800">Reward Points</h4>
                            <p class="text-2xl font-bold text-gray-900">${rewardPoints}</p>
                        </div>
                    </div>
                </div>

                 <div class="mt-6 bg-white p-4 rounded-lg shadow-sm">
                    <button onclick="showReferralModal()" class="w-full text-left flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg">
                        <span class="font-medium">Refer & Earn</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                    <button onclick="showPage('groupsListPage')" class="w-full text-left flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg mt-2">
                        <span class="font-medium">Your Groups</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                    <button class="w-full text-left flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg mt-2">
                        <span class="font-medium">Settings</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                </div>
                <div class="mt-6">
                     <button class="w-full max-w-sm mx-auto bg-red-100 text-red-600 font-bold py-3 rounded-lg hover:bg-red-200 transition flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                        Logout
                    </button>
                </div>
            `;
        }

        function renderGroupsListPage() {
            const container = pages.groupsListPage;
            container.innerHTML = `
                <header class="flex items-center mb-4">
                    <button onclick="showPage('accountPage')" class="mr-4 p-2 rounded-full hover:bg-gray-100">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    </button>
                    <h2 class="text-2xl font-bold text-gray-800">Your Groups</h2>
                </header>
                <div class="bg-white p-4 rounded-lg shadow-sm">
                    <button onclick="showPage('groupChatPage')" class="w-full text-left flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <img src="https://placehold.co/40x40/fbcfe8/9d174d?text=Style" alt="Group Icon" class="w-10 h-10 rounded-full mr-3">
                            <div>
                                <span class="font-medium">Style Savvy Group</span>
                                <p class="text-sm text-gray-500">Click to enter chat</p>
                            </div>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                </div>
            `;
        }


        function renderGroupChatPage() {
            groupChatMessagesContainer.innerHTML = groupChatMessages.map(msg => `
                <div class="w-full flex flex-col">
                    <div class="${msg.sender === 'Sudhanshu Singh' ? 'group-chat-own' : 'group-chat-other'} p-3 rounded-lg max-w-xs md:max-w-md break-words">
                        ${msg.sender !== 'Sudhanshu Singh' ? `<p class="text-xs font-bold text-pink-600">${msg.sender}</p>` : ''}
                        <p class="text-sm">${msg.text}</p>
                        <p class="text-xs text-right mt-1 ${msg.sender === 'Sudhanshu Singh' ? 'text-green-800' : 'text-gray-500'} opacity-75">${msg.timestamp}</p>
                    </div>
                </div>
            `).join('');
            groupChatMessagesContainer.scrollTop = groupChatMessagesContainer.scrollHeight;
        }

        function renderPlayAndWinPage() {
            const wheelLabels = document.getElementById('wheel-labels');
            const segmentAngle = 360 / wheelPrizes.length;

            wheelLabels.innerHTML = '';
            wheelPrizes.forEach((prize, index) => {
                const angle = (index * segmentAngle) + (segmentAngle / 2);

                const spoke = document.createElement('div');
                // The spoke is a line from the center to the top, which we rotate into position.
                spoke.className = 'absolute w-full h-1/2 top-0 left-0 origin-bottom';
                spoke.style.transform = `rotate(${angle}deg)`;

                const textContainer = document.createElement('div');
                // This container sits at the top of the spoke.
                // We push it out from the center and counter-rotate it to keep the text upright.
                textContainer.className = 'text-center';
                textContainer.style.transform = `translateY(25px) rotate(${-angle}deg)`;

                const text = document.createElement('span');
                text.className = 'block font-bold text-gray-700 text-sm';
                text.innerHTML = prize.label.replace(' ', '<br>');

                textContainer.appendChild(text);
                spoke.appendChild(textContainer);
                wheelLabels.appendChild(spoke);
            });
        }

        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountEl.textContent = totalItems;
        }

        // --- ACTIONS & EVENT HANDLERS ---
        
        function showPage(pageId) {
            currentPage = pageId;
            // Hide all pages
            for (const pageEl of Object.values(pages)) {
                if (pageEl) {
                    pageEl.classList.add('hidden');
                }
            }

            // Show the target page
            if (pages[pageId]) {
                pages[pageId].classList.remove('hidden');
            }
            
            window.scrollTo(0, 0);
            
            // Update bottom nav active state
            document.querySelectorAll('.bottom-nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.page === pageId) {
                    item.classList.add('active');
                }
            });
            
            // Re-render dynamic pages
            if (pageId === 'homePage') renderHomePage();
            if (pageId === 'cartPage') renderCartPage();
            if (pageId === 'ordersPage') renderOrdersPage();
            if (pageId === 'trendsPage') renderTrendsPage();
            if (pageId === 'playAndWinPage') renderPlayAndWinPage();
            if (pageId === 'accountPage') renderAccountPage();
            if (pageId === 'groupsListPage') renderGroupsListPage();
            if (pageId === 'groupChatPage') renderGroupChatPage();
        }

        function showCategory(categoryName) {
            let filteredProducts;
            let title;
            if (categoryName.toLowerCase() === 'all') {
                filteredProducts = products;
                title = "All Categories";
            } else {
                 filteredProducts = products.filter(p => p.category.toLowerCase() === categoryName.toLowerCase());
                 title = categoryName;
            }
            renderProductsPage(filteredProducts, title);
            showPage('productsPage');
        }
        
        function showProductDetail(productId) {
            renderProductDetailPage(productId);
            showPage('productDetailPage');
        }
        
        function addToCart(productId) {
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id: productId, quantity: 1 });
            }
            updateCartCount();
            showToast('Item added to cart!', 'info');
        }
        
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartCount();
            renderCartPage();
        }
        
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartCount();
                    renderCartPage();
                }
            }
        }
        
        function handleSearch() {
            const query = searchInput.value.toLowerCase();
            const filteredProducts = products.filter(p => p.name.toLowerCase().includes(query) || p.category.toLowerCase().includes(query));
            renderProductsPage(filteredProducts, `Search results for "${query}"`);
            showPage('productsPage');
        }

        function showToast(message = 'Item added to cart!', type = 'info') {
            const toast = document.getElementById('toast-notification');
            toast.textContent = message;

            toast.classList.remove('bg-green-500', 'bg-blue-500', 'bg-red-500');
            if (type === 'success') {
                toast.classList.add('bg-green-500');
            } else if (type === 'error') {
                toast.classList.add('bg-red-500');
            } else {
                toast.classList.add('bg-blue-500');
            }


            toast.style.animation = 'none';
            toast.offsetHeight; /* trigger reflow */
            toast.style.animation = null; 
            toast.classList.remove('opacity-0');

            setTimeout(() => {
                toast.classList.add('opacity-0');
            }, 2800);
        }

        function handleBuyNow(productId) {
            const existingItem = cart.find(item => item.id === productId);
            if (!existingItem) {
                const wasInCart = cart.find(item => item.id === productId);
                if (!wasInCart) {
                    cart.push({ id: productId, quantity: 1 });
                }
                updateCartCount();
            }
            showPage('cartPage');
        }

        function handleCheckout() {
            if (cart.length === 0) return;
            
            const subtotal = cart.reduce((sum, item) => {
                const product = products.find(p => p.id === item.id);
                return sum + (product.price * item.quantity);
            }, 0);
            const deliveryFee = subtotal > 500 ? 0 : 40;
            const total = subtotal + deliveryFee;

            const newOrder = {
                id: `ORD${Math.floor(Math.random() * 90000) + 10000}`,
                date: new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }),
                status: 'Processing',
                total: total,
                items: cart.map(cartItem => {
                    const product = products.find(p => p.id === cartItem.id);
                    return { ...product, quantity: cartItem.quantity };
                })
            };
            
            orders.unshift(newOrder);
            
            showToast('Thank you for your order!', 'success');
            
            setTimeout(() => {
                cart = [];
                updateCartCount();
                showPage('homePage');
            }, 500);
        }

        // --- TRENDS LOGIC ---
        function handleLike(trendId) {
            const trendPost = trends.find(t => t.id === trendId);
            if (trendPost) {
                if (trendPost.liked) {
                    trendPost.likes--;
                    trendPost.liked = false;
                } else {
                    trendPost.likes++;
                    trendPost.liked = true;
                }
                renderTrendsPage();
            }
        }

        // --- SPIN WHEEL LOGIC ---
        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;
            document.getElementById('spin-btn').disabled = true;

            const wheel = document.getElementById('wheel');
            const segmentAngle = 360 / wheelPrizes.length;
            const randomSegment = Math.floor(Math.random() * wheelPrizes.length);
            // Ensure prize lands in the middle of the segment, not on the line
            const randomAngleWithinSegment = (Math.random() * (segmentAngle - 20)) + 10; 
            
            const winningAngle = (randomSegment * segmentAngle) + randomAngleWithinSegment;
            const totalRotation = 360 * 10 - winningAngle;

            wheel.style.transform = `rotate(${totalRotation}deg)`;

            currentPrize = wheelPrizes[randomSegment];

            setTimeout(() => {
                showQuestionModal();
            }, 5500); // Wait for animation to finish
        }

        function showQuestionModal() {
            questionModal.classList.remove('hidden');
        }

        function hideQuestionModal() {
            questionModal.classList.add('hidden');
            document.getElementById('spin-btn').disabled = false;
            isSpinning = false;
        }

        function checkAnswer(selectedAnswer) {
            if (selectedAnswer === 10) { // Correct answer for 5+5
                if (typeof currentPrize.value === 'number') {
                    rewardPoints += currentPrize.value;
                    showToast(`You won ${currentPrize.value} points!`, 'success');
                    // We don't need to re-render account page unless user is on it
                    if (currentPage === 'accountPage') {
                        renderAccountPage();
                    }
                } else {
                    showToast(`You won! Winners will be emailed about the ${currentPrize.label}.`, 'success');
                }
            } else {
                showToast('Wrong answer. Better luck next time!', 'error');
            }
            hideQuestionModal();
        }

        // --- CHATBOT LOGIC ---
        function openChatbot() {
            chatbotModal.classList.remove('hidden');
            chatbotModal.classList.add('flex');
            setTimeout(() => {
                chatbotModalContent.classList.remove('translate-y-full');
            }, 10);
            if (chatMessages.children.length === 0) {
                 addChatMessage("Hello! I'm your friendly shopping assistant. How can I help you find the perfect item today? You can ask me to recommend products!", 'bot');
            }
        }

        function closeChatbot() {
            chatbotModalContent.classList.add('translate-y-full');
            setTimeout(() => {
                chatbotModal.classList.add('hidden');
                chatbotModal.classList.remove('flex');
            }, 300);
        }

        function addChatMessage(message, sender) {
            const messageEl = document.createElement('div');
            messageEl.className = `w-fit max-w-xs md:max-w-md p-3 text-sm break-words ${sender === 'user' ? 'chat-bubble-user' : 'chat-bubble-bot'}`;
            messageEl.textContent = message;
            chatMessages.appendChild(messageEl);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function handleSendMessage() {
            const message = chatInput.value.trim();
            if (message === '') return;
            addChatMessage(message, 'user');
            chatInput.value = '';
            setTimeout(() => generateBotResponse(message), 1000);
        }

        function generateBotResponse(userMessage) {
            const msg = userMessage.toLowerCase();
            let botResponse = "Sorry, I'm not sure how to help with that. Try asking for a product category like 'sarees' or ask me to 'recommend' something!";

            if (msg.includes('hello') || msg.includes('hi')) {
                botResponse = "Hi there! What are you looking for today? We have a great collection of sarees, kurtis, and more!";
            } else if (msg.includes('saree')) {
                botResponse = "Great choice! We have beautiful Banarasi and Georgette sarees. I can show you our collection. Just click on the Sarees category!";
            } else if (msg.includes('kurti')) {
                 botResponse = "We have some very stylish and comfortable Kurtis. Our Cotton Anarkali and Straight Rayon Kurtis are very popular. You can find them in the Kurtis section.";
            } else if (msg.includes('recommend') || msg.includes('suggest')) {
                const randomProduct = products[Math.floor(Math.random() * products.length)];
                botResponse = `I'd recommend the "${randomProduct.name}". It has a rating of ${randomProduct.rating} stars! You can find it in the ${randomProduct.category} category.`;
            } else if (msg.includes('thank')) {
                botResponse = "You're welcome! Happy shopping!";
            }
             addChatMessage(botResponse, 'bot');
        }

        function handleSendGroupMessage() {
            const text = groupChatInput.value.trim();
            if (text === '') return;
            
            const newMessage = {
                sender: 'Sudhanshu Singh',
                text: text,
                timestamp: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })
            };
            groupChatMessages.push(newMessage);
            groupChatInput.value = '';
            renderGroupChatPage();
        }

        // --- REFERRAL LOGIC ---
        function showReferralModal() {
            referralModal.classList.remove('hidden');
        }

        function hideReferralModal() {
            referralModal.classList.add('hidden');
        }

        function copyReferralLink() {
            const referralInput = document.getElementById('referral-link-input');
            const tempInput = document.createElement('input');
            tempInput.style.position = 'absolute';
            tempInput.style.left = '-9999px';
            tempInput.value = referralInput.value;
            document.body.appendChild(tempInput);
            tempInput.select();
            
            try {
                document.execCommand('copy');
                showToast('Referral link copied!', 'success');
            } catch (err) {
                showToast('Failed to copy link.', 'error'); 
            }

            document.body.removeChild(tempInput);
            hideReferralModal();
        }

        // --- SHARE LOGIC ---
        function showShareModal(productId) {
            productIdToShare = productId;
            const groupList = document.getElementById('share-group-list');
            // In a real app, you would loop through user's groups. Here we just have one.
            groupList.innerHTML = `
                <button onclick="shareProductToGroup('Style Savvy Group')" class="w-full text-left flex items-center p-3 hover:bg-gray-50 rounded-lg">
                    <img src="https://placehold.co/40x40/fbcfe8/9d174d?text=Style" alt="Group Icon" class="w-10 h-10 rounded-full mr-3">
                    <span class="font-medium">Style Savvy Group</span>
                </button>
            `;
            shareModal.classList.remove('hidden');
        }

        function hideShareModal() {
            shareModal.classList.add('hidden');
            productIdToShare = null;
        }

        function shareProductToGroup(groupName) { // We only have one group, so groupName is illustrative
            if (!productIdToShare) return;

            const product = products.find(p => p.id === productIdToShare);
            if (!product) return;

            const messageText = `Hey everyone, check out this product I found: "${product.name}"! It's only â‚¹${product.price}.`;

            const newMessage = {
                sender: 'Sudhanshu Singh',
                text: messageText,
                timestamp: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })
            };

            groupChatMessages.push(newMessage);
            hideShareModal();
            showToast('Shared to ' + groupName, 'success');
            
            setTimeout(() => {
                showPage('groupChatPage');
            }, 500); // Give toast some time to show
        }

        // --- AR/VR LOGIC ---
        function startARView() {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                const constraints = {
                    video: {
                        facingMode: 'environment' // Prefer the rear camera
                    }
                };

                navigator.mediaDevices.getUserMedia(constraints)
                    .then(function(stream) {
                        arStream = stream;
                        const video = document.getElementById('ar-video');
                        video.srcObject = stream;
                        arViewModal.classList.remove('hidden');
                    })
                    .catch(function(err) {
                        console.error("Error accessing camera: ", err);
                        showToast('Could not access camera. Please grant permission.', 'error');
                    });
            } else {
                showToast('AR feature not supported on your browser.', 'error');
            }
        }

        function stopARView() {
            if (arStream) {
                arStream.getTracks().forEach(track => track.stop());
            }
            arViewModal.classList.add('hidden');
            const video = document.getElementById('ar-video');
            video.srcObject = null;
            arStream = null;
        }


        // --- INITIALIZATION ---
        
        document.addEventListener('DOMContentLoaded', () => {
            showPage('homePage');
            updateCartCount();
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSearch();
                }
            });

            document.querySelectorAll('.bottom-nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    const page = item.dataset.page;
                    if (page === 'productsPage') {
                        showCategory('all');
                    } else if (page) {
                       showPage(page);
                    }
                });
            });

            // Chatbot event listeners
            chatbotToggle.addEventListener('click', openChatbot);
            closeChatbotBtn.addEventListener('click', closeChatbot);
            sendChatBtn.addEventListener('click', handleSendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if(e.key === 'Enter') handleSendMessage();
            });
            chatbotModal.addEventListener('click', (e) => {
                if(e.target === chatbotModal) closeChatbot();
            });

            // Group Chat event listeners
            sendGroupChatBtn.addEventListener('click', handleSendGroupMessage);
            groupChatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSendGroupMessage();
            });

            // Share Modal listener
            shareModal.addEventListener('click', (e) => {
                if (e.target === shareModal) {
                    hideShareModal();
                }
            });

            // Referral Modal listener
            referralModal.addEventListener('click', (e) => {
                if (e.target === referralModal) {
                    hideReferralModal();
                }
            });

            // Spin Wheel listener
            document.getElementById('spin-btn').addEventListener('click', spinWheel);
            questionModal.addEventListener('click', (e) => {
                if (e.target === questionModal) {
                    hideQuestionModal();
                }
            });
        });
    </script>
</body>
</html>
"

